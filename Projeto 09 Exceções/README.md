Código da Agenda com exceção.
Demorei alguns minutos. Tive alguns problemas mas foi só questão de estudar mais, mesmo.